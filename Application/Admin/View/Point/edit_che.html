<extend name="Index:app" />
<block name="css">

</block>
<block name="content">
	<div class="row">
		<div class="col-md-12">
			<!-- Horizontal Form -->
			<div class="box box-info">
				<div class="box-header with-border">
					<h3 class="box-title">产品编辑</h3>
				</div>
				<!-- /.box-header -->
				<!-- form start -->
				<form class="form-horizontal" action="{:U('Point/update_che')}" method="post" enctype="multipart/form-data">
					<div class="box-body">
						<div class="form-group">
							<label for="inputEmail3" class="col-sm-2 control-label">文章分类</label>
							<div class="col-sm-6">
								<!-- Single button -->
								<select class="form-control" style="width:30%;" id="art_cate_id" name="art_cate_id">
									<!--<option value="0">|_&nbsp;一级分类&nbsp;</option>-->
									<volist name="list2" id="vo">
										<option value="{$vo.cate_id}" <if condition="$vo.cate_id eq $obj.art_cate_id ">selected </if> >|_&nbsp;{$vo.cate_name}&nbsp;</option>
									</volist>
								</select>
							</div>
						</div>
					</div>
					<input type="hidden" id="art_id" name="art_id" value="{$obj.art_id}">
					<div class="box-body">
						<div class="form-group">
							<label for="inputEmail3" class="col-sm-2 control-label">供应商</label>
							<div class="col-sm-6">

								<select class="form-control" style="width:30%;" id="gong_id" name="gong_id">

									<volist name="gong" id="vo">
										<option value="{$vo.id}">|_&nbsp;{$vo.name}&nbsp;</option>
									</volist>
								</select>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">产品名称</label>

						<div class="col-sm-6">
							<input type="text" class="form-control" id="art_title" name="art_title" value="{$obj.product_title}">
						</div>
					</div>
					<!--<div class="form-group">-->
						<!--<label for="inputPassword3" class="col-sm-2 control-label">Banner视频</label>-->

						<!--<div class="col-sm-6">-->
							<!--<textarea class="form-control" id="shipin" name="shipin" style="height: 55px; width: 100%;">{$obj.shipin}</textarea>-->
						<!--</div>-->
					<!--</div>-->
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">详情视频</label>

						<div class="col-sm-6">
							
							<input class="form-control" id="xiang_shipin" name="xiang_shipin"   value="{$obj.xiang_shipin}"/>
							<input name="Submit11" type="button" class="input_bot" onClick="window.open('{:U('point/cheDetVideo')}','','status=no,scrollbars=no,top=20,left=110,width=420,height=165')"  value="选择视频" />
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">产品图片</label>

						<div class="col-sm-6" style="margin-top: 5px">
							<input type="text" name="images" size="40" style="height:22px" id="images" value="{$obj.art_img_url}">
							<input name="Submit11" type="button" class="input_bot" onClick="window.open('{:U('Admin/ProductManagement/jin')}','','status=no,scrollbars=no,top=20,left=110,width=420,height=165')" value="选择图片" /></td>

						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">banns图1</label>

						<div class="col-sm-6" style="margin-top: 5px">
							<input type="text" name="image" size="40" style="height:22px" id="image" value="{$obj.art_img_url_s}">
							<input name="Submit11" type="button" class="input_bot" onClick="window.open('{:U('Admin/ProductManagement/jing')}','','status=no,scrollbars=no,top=20,left=110,width=420,height=165')" value="选择图片" /></td>

						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">banns图2</label>

						<div class="col-sm-6" style="margin-top: 5px">
							<input type="text" name="imag" size="40" style="height:22px" id="imag" value="{$obj.art_title}">
							<input name="Submit11" type="button" class="input_bot" onClick="window.open('{:U('Admin/ProductManagement/jinter')}','','status=no,scrollbars=no,top=20,left=110,width=420,height=165')" value="选择图片" /></td>

						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">banns图3</label>

						<div class="col-sm-6" style="margin-top: 5px">
							<input type="text" name="imagester" size="40" style="height:22px" id="imagester" value="{$obj.art_keywords}">
							<input name="Submit11" type="button" class="input_bot" onClick="window.open('{:U('Admin/ProductManagement/jinst')}','','status=no,scrollbars=no,top=20,left=110,width=420,height=165')" value="选择图片" /></td>

						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">banns图4</label>

						<div class="col-sm-6" style="margin-top: 5px">
							<input type="text" name="imagestu" size="40" style="height:22px" id="imagestu" value="{$obj.art_description}">
							<input name="Submit11" type="button" class="input_bot" onClick="window.open('{:U('Admin/ProductManagement/jintu')}','','status=no,scrollbars=no,top=20,left=110,width=420,height=165')" value="选择图片" /></td>

						</div>
					</div>

					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">产品说明</label>

						<div class="col-sm-6">
							<input type="text" class="form-control" id="art_shuo" name="art_shuo" value="{$obj.guige}">
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">邮费</label>

						<div class="col-sm-6">
							<input type="text" class="form-control" id="art_you" name="art_you" value="{$obj.youdi}">
						</div>
					</div>
					<div class="form-group">
						<label for="inputEmail3" class="col-sm-2 control-label">是否上架</label>
						<div class="col-sm-6" style="padding:6px 0 0 12px">
							<div style="display: inline-block;margin-right:10px">&nbsp;上架&nbsp;
								<if condition="$obj['type'] eq 1">
									<input style="vertical-align: middle;margin-top:-2px;" type="radio" name="type" checked="checked" value="1" id="checkbox" />
									<else/>
									<input style="vertical-align: middle;margin-top:-2px;" type="radio" name="type" value="1" id="checkbox" />
								</if>
							</div>
							<div style="display: inline-block;margin-right:5px">&nbsp;下架&nbsp;
								<if condition="$obj['type'] eq 0">
									<input style="vertical-align: middle;margin-top:-2px;" type="radio" name="type" checked="checked" value="0" id="checkbox" />
									<else/>
									<input style="vertical-align: middle;margin-top:-2px;" type="radio" name="type" value="0" id="checkbox" />
								</if>
							</div>
						</div>
					</div>

					<div class="form-group">
						<label for="inputEmail3" class="col-sm-2 control-label">规格</label>
						<div class="col-sm-6" style="padding:6px 0 0 12px">
							<div style="display: inline-block;margin-right:10px">&nbsp;有&nbsp;
								<input <if condition="$obj.has_spec eq 1"> checked </if> style="vertical-align: middle;margin-top:-2px;" type="radio"   name="has_spec" value="1"  onclick="tt()" /></div>
							<div style="display: inline-block;margin-right:5px">&nbsp;无&nbsp;
								<input <if condition="$obj.has_spec eq 0"> checked  </if> style="vertical-align: middle;margin-top:-2px;"  type="radio" name="has_spec" value="0" onclick="yin()" /></div>
						</div>
					</div>


					<div class="form-group no_guige" style="display: none;">
						<label for="inputPassword3" class="col-sm-2 control-label">产品商城价(积分)</label>

						<div class="col-sm-6">
							<input type="text" class="form-control" id="art_jiage" name="art_jiage" value="{$obj.jiage}">
						</div>
					</div>
					<div class="form-group no_guige" style="display: none;">
						<label for="inputPassword3" class="col-sm-2 control-label">产品价格(积分)</label>

						<div class="col-sm-6">
							<input type="text" class="form-control" id="huiyuan" name="huiyuan" value="{$obj.huiyuan}">
						</div>
					</div>


					<div class="form-group no_guige" style="display: none;">
						<label for="inputPassword3" class="col-sm-2 control-label">产品库存</label>

						<div class="col-sm-6">
							<input type="text" class="form-control" id="art_kucun" name="art_kucun" value="{$obj.num}">
						</div>
					</div>


					<div class="form-group has_guige" style="display: none;">
						<label for="inputPassword3" class="col-sm-2 control-label">商品规格</label>

						<div class="col-sm-6">
							<div id="ajax_spec_data" class="form-group">

								<table class="table table-bordered" id="goods_spec_table1">

									<tr>
										<td style="width: 90px;">规格项</td>
										<td>
											产品商城价(积分)
										</td>
										<td>
											产品价格(积分)
										</td>
										<td>
											库存
										</td>
									</tr>
									<tbody id="goods_sp">
										<volist name="guige" id="ho" key="k">
											<tr>
												<td style="width: 90px;">
													<input type="text" name="gui{$k}" value="{$ho.guige}" >
												</td>

												<td>
													<input type="text" name="point_shop{$k}" value="{$ho.point_shop}">
												</td>
												<td>
													<input type="text" name="point{$k}" value="{$ho.point}">
												</td>
	
												<td>
													<input type="text" name="num{$k}" value="{$ho.num}">
												</td>
											</tr>
										</volist>
										
									</tbody>

								</table>

							</div>
						</div>
						
						<div>
							<div id="tian" class=" btn btn-success" style="margin-left: 20px;">添加</div>
						</div>
					</div>

					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">纵览</label>

						<div class="col-sm-9">
							<textarea id="editor_id" name="art_content" style="height: 500px; width: 100%;">{$obj.art_content}</textarea>
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">使用说明</label>

						<div class="col-sm-9">
							<textarea id="editor_id" name="content" style="height: 500px; width: 100%;">{$obj.content}</textarea>
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword3" class="col-sm-2 control-label">产品资质</label>

						<div class="col-sm-9">
							<textarea id="editor_id" name="cont" style="height: 500px; width: 100%;">{$obj.cont}</textarea>
						</div>
					</div>
					<!-- /.box-body -->
					<div class="box-footer">
						<div class="col-sm-2">
						</div>
						<div class="col-sm-10">
							<button type="submit" class="btn btn-primary">提&nbsp;&nbsp;交</button>
						</div>

					</div>
					<!-- /.box-footer -->
				</form>
			</div>
			<!-- /.box -->
			<!-- general form elements disabled -->

			<!-- /.box -->
		</div>
	</div>
</block>
<block name="js">
	<script>
		 
		   
		var tiannum = "{$chang}";
		$("#tian").click(function() {
			tiannum++
			var tianhtml = ` <tr>
								        <td style="width: 90px;">
								        	<input type="text" name="${'gui'+tiannum}" id="${'gui'+tiannum}">
								        </td>
								        <td>                            
								            <input type="text" name="${'point_shop'+tiannum}" id="${'point_shop'+tiannum}">
								        </td>

								        <td>
								            <input type="text" name="${'point'+tiannum}" id="${'point'+tiannum}">
								        </td>
								        
								        <td>                            
								            <input type="text" name="${'num'+tiannum}" id="${'num'+tiannum}">
								        </td>
								    </tr> `

			$("#goods_sp").append(tianhtml);

		})

        function tt(){
            $('.has_guige').css('display','block')
            $('.no_guige').css('display','none')
        }
        function yin(){
            $('.no_guige').css('display','block')
            $('.has_guige').css('display','none')

        }

        // alert({$obj.has_spec});
        if({$obj.has_spec} == 1){ //有规格
            tt();
		}else{ //无规格
            yin();
		}
		

		
		
//		// 按钮切换 class
//		$("#ajax_spec_data button").click(function() {
//			if($(this).hasClass('btn-success')) {
//				$(this).removeClass('btn-success');
//				$(this).addClass('btn-default');
//			} else {
//				$(this).removeClass('btn-default');
//				$(this).addClass('btn-success');
//			}
//			ajaxGetSpecInput();
//		});
//
//		/**
//		 *  点击商品规格触发下面输入框显示
//		 */
//		function ajaxGetSpecInput() {
//
//			var spec_arr = {}; // 用户选择的规格数组
//
//			// 选中了哪些属性	  
//			$("#goods_spec_table1  button").each(function() {
//				if($(this).hasClass('btn-success')) {
//					var spec_id = $(this).data('spec_id'); //所属的类别id
//					var item_id = $(this).data('item_id'); //第几个
//
//					if(!spec_arr.hasOwnProperty(spec_id))
//						spec_arr[spec_id] = [];
//					spec_arr[spec_id].push(item_id);
//
//				}
//
//			});
//			ajaxGetSpecInput2(spec_arr); // 显示下面的输入框
//
//		}
//
//		/**
//		 * 根据用户选择的不同规格选项 
//		 * 返回 不同的输入框选项
//		 */
//		function ajaxGetSpecInput2(spec_arr) {
//
//			$.ajax({
//				type: 'POST',
//				data: {
//					'spec_arr': spec_arr
//				},
//				url: "/index.php/Admin/ProductManagement/ajaxGetSpecInput",
//				success: function(data) {
//
//					$("#goods_spec_table2").html('')
//					$("#goods_spec_table2").append(data);
//					hbdyg(); // 合并单元格
//				}
//			});
//		}
//
//		ajaxGetSpec();
//		/**
//		 *  点击商品规格触发下面输入框显示
//		 */
//		function ajaxGetSpec() {
//
//			var spec_arr = {}; // 用户选择的规格数组
//
//			// 选中了哪些属性	  
//			$("#goods_spec_table1  button").each(function() {
//				if($(this).hasClass('btn-success')) {
//					var spec_id = $(this).data('spec_id'); //所属的类别id
//					var item_id = $(this).data('item_id'); //第几个
//
//					if(!spec_arr.hasOwnProperty(spec_id))
//						spec_arr[spec_id] = [];
//					spec_arr[spec_id].push(item_id);
//
//				}
//
//			});
//			ajaxGetSpecInput1(spec_arr); // 显示下面的输入框
//
//		}
//
//		/**
//		 * 根据用户选择的不同规格选项 
//		 * 返回 不同的输入框选项
//		 */
//		function ajaxGetSpecInput1(spec_arr) {
//			var ids = "{$obj.art_id}"
//
//			$.ajax({
//				type: 'POST',
//				data: {
//					'spec_arr': spec_arr,
//					'ids': ids
//				},
//				url: "/index.php/Admin/ProductManagement/ajaxGet",
//				success: function(data) {
//
//					$("#goods_spec_table2").html('')
//					$("#goods_spec_table2").append(data);
//					hbdyg(); // 合并单元格
//				}
//			});
//		}
//
//		// 合并单元格
//		function hbdyg() {
//			var tab = document.getElementById("spec_input_tab"); //要合并的tableID
//			var maxCol = 2,
//				val, count, start; //maxCol：合并单元格作用到多少列  
//			if(tab != null) {
//				for(var col = maxCol - 1; col >= 0; col--) {
//					count = 1;
//					val = "";
//					for(var i = 0; i < tab.rows.length; i++) {
//						if(val == tab.rows[i].cells[col].innerHTML) {
//							count++;
//						} else {
//							if(count > 1) { //合并
//								start = i - count;
//								tab.rows[start].cells[col].rowSpan = count;
//								for(var j = start + 1; j < i; j++) {
//									tab.rows[j].cells[col].style.display = "none";
//								}
//								count = 1;
//							}
//							val = tab.rows[i].cells[col].innerHTML;
//						}
//					}
//					if(count > 1) { //合并，最后几行相同的情况下
//						start = i - count;
//						tab.rows[start].cells[col].rowSpan = count;
//						for(var j = start + 1; j < i; j++) {
//							tab.rows[j].cells[col].style.display = "none";
//						}
//					}
//				}
//			}
//		}
	</script>
</block>